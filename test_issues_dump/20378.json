{
  "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378",
  "repository_url": "https://api.github.com/repos/eclipse-openj9/openj9",
  "labels_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378/labels{/name}",
  "comments_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378/comments",
  "events_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378/events",
  "html_url": "https://github.com/eclipse-openj9/openj9/issues/20378",
  "id": 2595443820,
  "node_id": "I_kwDOBgtddc6as1Rs",
  "number": 20378,
  "title": "getAndSet not inlined for Java.util.concurrency.atomic.Atomiclong and AtomicLongArray",
  "user": {
    "login": "matthewhall2",
    "id": 59631034,
    "node_id": "MDQ6VXNlcjU5NjMxMDM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/59631034?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matthewhall2",
    "html_url": "https://github.com/matthewhall2",
    "followers_url": "https://api.github.com/users/matthewhall2/followers",
    "following_url": "https://api.github.com/users/matthewhall2/following{/other_user}",
    "gists_url": "https://api.github.com/users/matthewhall2/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matthewhall2/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matthewhall2/subscriptions",
    "organizations_url": "https://api.github.com/users/matthewhall2/orgs",
    "repos_url": "https://api.github.com/users/matthewhall2/repos",
    "events_url": "https://api.github.com/users/matthewhall2/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matthewhall2/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 697962585,
      "node_id": "MDU6TGFiZWw2OTc5NjI1ODU=",
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/labels/comp:jit",
      "name": "comp:jit",
      "color": "1d76db",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "Spencer-Comin",
    "id": 52704940,
    "node_id": "MDQ6VXNlcjUyNzA0OTQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Spencer-Comin",
    "html_url": "https://github.com/Spencer-Comin",
    "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
    "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
    "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
    "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
    "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
    "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Spencer-Comin",
      "id": 52704940,
      "node_id": "MDQ6VXNlcjUyNzA0OTQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Spencer-Comin",
      "html_url": "https://github.com/Spencer-Comin",
      "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
      "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
      "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
      "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
      "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
      "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2024-10-17T18:28:53Z",
  "updated_at": "2024-10-22T15:30:53Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "sub_issues_summary": {
    "total": 0,
    "completed": 0,
    "percent_completed": 0
  },
  "body": "On Z in J9CodeGenerator::inlineDirectCall, the atomics for getAndSet for AtomicLong and AtomicLongArray are not being inlined, even though they are being inlined for the integer versions (AtomicInteger and AtomicIntegerArray).\r\n\r\ngetAndSet for Long types appears to be covered in Z::J9TreeEvaluator::inlineAtomicOps, and are included J9RecognizedMethods.enum. It looks like it may have just been missed in J9CodeGenerator::inlineDirectCall\r\n\r\n@Spencer-Comin ",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "timeline_data": [
    {
      "id": 14703799601,
      "node_id": "MEE_lADOBgtddc6as1RszwAAAANsai0x",
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/events/14703799601",
      "actor": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "event": "mentioned",
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-17T18:28:54Z",
      "performed_via_github_app": null
    },
    {
      "id": 14703799608,
      "node_id": "SE_lADOBgtddc6as1RszwAAAANsai04",
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/events/14703799608",
      "actor": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "event": "subscribed",
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-17T18:28:54Z",
      "performed_via_github_app": null
    },
    {
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2420251553",
      "html_url": "https://github.com/eclipse-openj9/openj9/issues/20378#issuecomment-2420251553",
      "issue_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378",
      "id": 2420251553,
      "node_id": "IC_kwDOBgtddc6QQhuh",
      "user": {
        "login": "github-actions[bot]",
        "id": 41898282,
        "node_id": "MDM6Qm90NDE4OTgyODI=",
        "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/github-actions%5Bbot%5D",
        "html_url": "https://github.com/apps/github-actions",
        "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "created_at": "2024-10-17T18:29:19Z",
      "updated_at": "2024-10-17T18:29:19Z",
      "author_association": "NONE",
      "body": "Issue Number: 20378\nStatus: Open\nRecommended Components: comp:vm, comp:gc, comp:test\nRecommended Assignees: keithc-ca, hangshao0, gacholio\n",
      "reactions": {
        "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2420251553/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "performed_via_github_app": {
        "id": 15368,
        "client_id": "Iv1.05c79e9ad1f6bdfa",
        "slug": "github-actions",
        "node_id": "MDM6QXBwMTUzNjg=",
        "owner": {
          "login": "github",
          "id": 9919,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/github",
          "html_url": "https://github.com/github",
          "followers_url": "https://api.github.com/users/github/followers",
          "following_url": "https://api.github.com/users/github/following{/other_user}",
          "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/github/subscriptions",
          "organizations_url": "https://api.github.com/users/github/orgs",
          "repos_url": "https://api.github.com/users/github/repos",
          "events_url": "https://api.github.com/users/github/events{/privacy}",
          "received_events_url": "https://api.github.com/users/github/received_events",
          "type": "Organization",
          "user_view_type": "public",
          "site_admin": false
        },
        "name": "GitHub Actions",
        "description": "Automate your workflow from idea to production",
        "external_url": "https://help.github.com/en/actions",
        "html_url": "https://github.com/apps/github-actions",
        "created_at": "2018-07-30T09:30:17Z",
        "updated_at": "2025-03-07T16:35:00Z",
        "permissions": {
          "actions": "write",
          "administration": "read",
          "attestations": "write",
          "checks": "write",
          "contents": "write",
          "deployments": "write",
          "discussions": "write",
          "issues": "write",
          "merge_queues": "write",
          "metadata": "read",
          "models": "read",
          "packages": "write",
          "pages": "write",
          "pull_requests": "write",
          "repository_hooks": "write",
          "repository_projects": "write",
          "security_events": "write",
          "statuses": "write",
          "vulnerability_alerts": "read"
        },
        "events": [
          "branch_protection_rule",
          "check_run",
          "check_suite",
          "create",
          "delete",
          "deployment",
          "deployment_status",
          "discussion",
          "discussion_comment",
          "fork",
          "gollum",
          "issues",
          "issue_comment",
          "label",
          "merge_group",
          "milestone",
          "page_build",
          "project",
          "project_card",
          "project_column",
          "public",
          "pull_request",
          "pull_request_review",
          "pull_request_review_comment",
          "push",
          "registry_package",
          "release",
          "repository",
          "repository_dispatch",
          "status",
          "watch",
          "workflow_dispatch",
          "workflow_run"
        ]
      },
      "event": "commented",
      "actor": {
        "login": "github-actions[bot]",
        "id": 41898282,
        "node_id": "MDM6Qm90NDE4OTgyODI=",
        "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/github-actions%5Bbot%5D",
        "html_url": "https://github.com/apps/github-actions",
        "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      }
    },
    {
      "id": 14722047833,
      "node_id": "LE_lADOBgtddc6as1RszwAAAANtgJ9Z",
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/events/14722047833",
      "actor": {
        "login": "hangshao0",
        "id": 18008382,
        "node_id": "MDQ6VXNlcjE4MDA4Mzgy",
        "avatar_url": "https://avatars.githubusercontent.com/u/18008382?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hangshao0",
        "html_url": "https://github.com/hangshao0",
        "followers_url": "https://api.github.com/users/hangshao0/followers",
        "following_url": "https://api.github.com/users/hangshao0/following{/other_user}",
        "gists_url": "https://api.github.com/users/hangshao0/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hangshao0/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hangshao0/subscriptions",
        "organizations_url": "https://api.github.com/users/hangshao0/orgs",
        "repos_url": "https://api.github.com/users/hangshao0/repos",
        "events_url": "https://api.github.com/users/hangshao0/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hangshao0/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "event": "labeled",
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-18T14:32:59Z",
      "label": {
        "name": "comp:jit",
        "color": "1d76db"
      },
      "performed_via_github_app": null
    },
    {
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2429604204",
      "html_url": "https://github.com/eclipse-openj9/openj9/issues/20378#issuecomment-2429604204",
      "issue_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378",
      "id": 2429604204,
      "node_id": "IC_kwDOBgtddc6Q0NFs",
      "user": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "created_at": "2024-10-22T15:30:37Z",
      "updated_at": "2024-10-22T15:30:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "The atomic operations in `java.util.concurrent.atomic.Atomic*` classes are _not_ marked as intrinsics. The JCL implementations call out to the atomic operations in `Unsafe`, which _are_ marked as intrinsics.\r\n\r\nJust poked through the code and ran some tests to see what we are doing:\r\n\r\n```\r\n============================================================\r\n; Live regs: GPR=2 FPR=0 VRF=0 {&GPR_0033, GPR_0032}\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff7da847d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  2)    icall  java/util/concurrent/atomic/AtomicInteger.getAndSet(I)I[#403  final virtual Method -136] [flags 0x20500 0x0 ]  [     0x3ff7da84780] bci=[-1,2,6] rc=2 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  1)      ==>aRegLoad (in &GPR_0033) (SeenRealReference )\r\n n40n     (  1)      ==>iRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\nInstruction 000003FF7DB52080 throws an implicit NPE, node: 000003FF7DA84780 NPE node: 000003FF7DA852C0\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff7da847d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  1)    icall  java/util/concurrent/atomic/AtomicInteger.getAndSet(I)I[#403  final virtual Method -136] [flags 0x20500 0x0 ] (in GPR_0034)  [     0x3ff7da84780] bci=[-1,2,6] rc=1 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  0)      ==>aRegLoad (in &GPR_0033) (X!=0 SeenRealReference )\r\n n40n     (  0)      ==>iRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\n\r\n [     0x3ff7db51ce0]                          CGIT    &GPR_0033,0,BH(mask=0x8),\r\n [     0x3ff7db52080]                          LG      GPR_0034,#405 8(&GPR_0033)\r\n [     0x3ff7dc00000]                          Label L0033:     # (Start of internal control flow)\r\n [     0x3ff7dc001a0]                          CS      GPR_0034,GPR_0032,#406 8(&GPR_0033)\r\n [     0x3ff7dc00280]                          BRC     BM(0x4), Label L0033\r\n [     0x3ff7dc00920]                          assocreg\r\n [     0x3ff7dc00360]                          Label L0032:     # (End of internal control flow)\r\n POST:\r\n {AssignAny:&GPR_0033:R} {AssignAny:GPR_0034:R} {AssignAny:GPR_0032:R}\r\n```\r\n\r\n```\r\n============================================================\r\n; Live regs: GPR=2 FPR=0 VRF=0 {&GPR_0033, GPR_0032}\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff58e047d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  2)    lcall  java/util/concurrent/atomic/AtomicLong.getAndSet(J)J[#403  final virtual Method -136] [flags 0x20500 0x0 ]  [     0x3ff58e04780] bci=[-1,2,6] rc=2 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  1)      ==>aRegLoad (in &GPR_0033) (SeenRealReference )\r\n n40n     (  1)      ==>lRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\n\r\nbuildDirectDispatch\r\nBuild Direct Call\r\n\r\nGC Point at 000003FF58F80BD0 has preserved register map 1fc0\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff58e047d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  1)    lcall  java/util/concurrent/atomic/AtomicLong.getAndSet(J)J[#403  final virtual Method -136] [flags 0x20500 0x0 ] (in GPR_0034)  [     0x3ff58e04780] bci=[-1,2,6] rc=1 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  0)      ==>aRegLoad (in &GPR_0033) (X!=0 SeenRealReference )\r\n n40n     (  0)      ==>lRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\n\r\n [     0x3ff58ed1ce0]                          CGIT    &GPR_0033,0,BH(mask=0x8),\r\n [     0x3ff58f811c0]                          assocreg\r\n  PRE:\r\n {GPR1:&GPR_0033:R} {GPR2:GPR_0032:R}\r\n [     0x3ff58f80bd0]                          BRASL   GPR_0039, 0x000003FF58F80B60\r\n POST:\r\n {GPR2:GPR_0034:D} {GPR0:D_GPR_0035:D}* {GPR1:D_GPR_0036:D}* {GPR3:D_GPR_0037:D}* {GPR4:D_GPR_0038:D}* {GPR14:GPR_0039:D} {FPR0:D_FPR_0040:D}* {FPR1:D_FPR_0041:D}*\r\n {FPR2:D_FPR_0042:D}* {FPR3:D_FPR_0043:D}* {FPR4:D_FPR_0044:D}* {FPR5:D_FPR_0045:D}* {FPR6:D_FPR_0046:D}* {FPR7:D_FPR_0047:D}* {FPR8:D_FPR_0048:D}* {FPR9:D_FPR_0049:D}*\r\n {FPR10:D_FPR_0050:D}* {FPR11:D_FPR_0051:D}* {FPR12:D_FPR_0052:D}* {FPR13:D_FPR_0053:D}* {FPR14:D_FPR_0054:D}* {FPR15:D_FPR_0055:D}* {VRF16:D_VRF_0056:D}* {VRF17:D_VRF_0057:D}*\r\n {VRF18:D_VRF_0058:D}* {VRF19:D_VRF_0059:D}* {VRF20:D_VRF_0060:D}* {VRF21:D_VRF_0061:D}* {VRF22:D_VRF_0062:D}* {VRF23:D_VRF_0063:D}* {VRF24:D_VRF_0064:D}* {VRF25:D_VRF_0065:D}*\r\n {VRF26:D_VRF_0066:D}* {VRF27:D_VRF_0067:D}* {VRF28:D_VRF_0068:D}* {VRF29:D_VRF_0069:D}* {VRF30:D_VRF_0070:D}* {VRF31:D_VRF_0071:D}*\r\n ```\r\n\r\nIt looks like we are suppressing the IL inlining of `AtomicInteger.getAndSet` and `AtomicLong.getAndSet`, then in the case of  `AtomicInteger.getAndSet` we are recognizing the call site and generating some custom assembly. Since the `Atomic*` class methods are not intrinsics, we should probably not be suppressing inlining these methods and instead rely on the `Unsafe` atomic intrinsic implementations.",
      "reactions": {
        "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2429604204/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "performed_via_github_app": null,
      "event": "commented",
      "actor": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      }
    },
    {
      "id": 14787882405,
      "node_id": "AE_lADOBgtddc6as1RszwAAAANxbS2l",
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/events/14787882405",
      "actor": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "event": "assigned",
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-22T15:30:52Z",
      "assignee": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "performed_via_github_app": null
    }
  ],
  "comments_data": [
    {
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2420251553",
      "html_url": "https://github.com/eclipse-openj9/openj9/issues/20378#issuecomment-2420251553",
      "issue_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378",
      "id": 2420251553,
      "node_id": "IC_kwDOBgtddc6QQhuh",
      "user": {
        "login": "github-actions[bot]",
        "id": 41898282,
        "node_id": "MDM6Qm90NDE4OTgyODI=",
        "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/github-actions%5Bbot%5D",
        "html_url": "https://github.com/apps/github-actions",
        "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "created_at": "2024-10-17T18:29:19Z",
      "updated_at": "2024-10-17T18:29:19Z",
      "author_association": "NONE",
      "body": "Issue Number: 20378\nStatus: Open\nRecommended Components: comp:vm, comp:gc, comp:test\nRecommended Assignees: keithc-ca, hangshao0, gacholio\n",
      "reactions": {
        "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2420251553/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "performed_via_github_app": {
        "id": 15368,
        "client_id": "Iv1.05c79e9ad1f6bdfa",
        "slug": "github-actions",
        "node_id": "MDM6QXBwMTUzNjg=",
        "owner": {
          "login": "github",
          "id": 9919,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/github",
          "html_url": "https://github.com/github",
          "followers_url": "https://api.github.com/users/github/followers",
          "following_url": "https://api.github.com/users/github/following{/other_user}",
          "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/github/subscriptions",
          "organizations_url": "https://api.github.com/users/github/orgs",
          "repos_url": "https://api.github.com/users/github/repos",
          "events_url": "https://api.github.com/users/github/events{/privacy}",
          "received_events_url": "https://api.github.com/users/github/received_events",
          "type": "Organization",
          "user_view_type": "public",
          "site_admin": false
        },
        "name": "GitHub Actions",
        "description": "Automate your workflow from idea to production",
        "external_url": "https://help.github.com/en/actions",
        "html_url": "https://github.com/apps/github-actions",
        "created_at": "2018-07-30T09:30:17Z",
        "updated_at": "2025-03-07T16:35:00Z",
        "permissions": {
          "actions": "write",
          "administration": "read",
          "attestations": "write",
          "checks": "write",
          "contents": "write",
          "deployments": "write",
          "discussions": "write",
          "issues": "write",
          "merge_queues": "write",
          "metadata": "read",
          "models": "read",
          "packages": "write",
          "pages": "write",
          "pull_requests": "write",
          "repository_hooks": "write",
          "repository_projects": "write",
          "security_events": "write",
          "statuses": "write",
          "vulnerability_alerts": "read"
        },
        "events": [
          "branch_protection_rule",
          "check_run",
          "check_suite",
          "create",
          "delete",
          "deployment",
          "deployment_status",
          "discussion",
          "discussion_comment",
          "fork",
          "gollum",
          "issues",
          "issue_comment",
          "label",
          "merge_group",
          "milestone",
          "page_build",
          "project",
          "project_card",
          "project_column",
          "public",
          "pull_request",
          "pull_request_review",
          "pull_request_review_comment",
          "push",
          "registry_package",
          "release",
          "repository",
          "repository_dispatch",
          "status",
          "watch",
          "workflow_dispatch",
          "workflow_run"
        ]
      }
    },
    {
      "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2429604204",
      "html_url": "https://github.com/eclipse-openj9/openj9/issues/20378#issuecomment-2429604204",
      "issue_url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/20378",
      "id": 2429604204,
      "node_id": "IC_kwDOBgtddc6Q0NFs",
      "user": {
        "login": "Spencer-Comin",
        "id": 52704940,
        "node_id": "MDQ6VXNlcjUyNzA0OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/52704940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Spencer-Comin",
        "html_url": "https://github.com/Spencer-Comin",
        "followers_url": "https://api.github.com/users/Spencer-Comin/followers",
        "following_url": "https://api.github.com/users/Spencer-Comin/following{/other_user}",
        "gists_url": "https://api.github.com/users/Spencer-Comin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Spencer-Comin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Spencer-Comin/subscriptions",
        "organizations_url": "https://api.github.com/users/Spencer-Comin/orgs",
        "repos_url": "https://api.github.com/users/Spencer-Comin/repos",
        "events_url": "https://api.github.com/users/Spencer-Comin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Spencer-Comin/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "created_at": "2024-10-22T15:30:37Z",
      "updated_at": "2024-10-22T15:30:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "The atomic operations in `java.util.concurrent.atomic.Atomic*` classes are _not_ marked as intrinsics. The JCL implementations call out to the atomic operations in `Unsafe`, which _are_ marked as intrinsics.\r\n\r\nJust poked through the code and ran some tests to see what we are doing:\r\n\r\n```\r\n============================================================\r\n; Live regs: GPR=2 FPR=0 VRF=0 {&GPR_0033, GPR_0032}\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff7da847d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  2)    icall  java/util/concurrent/atomic/AtomicInteger.getAndSet(I)I[#403  final virtual Method -136] [flags 0x20500 0x0 ]  [     0x3ff7da84780] bci=[-1,2,6] rc=2 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  1)      ==>aRegLoad (in &GPR_0033) (SeenRealReference )\r\n n40n     (  1)      ==>iRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\nInstruction 000003FF7DB52080 throws an implicit NPE, node: 000003FF7DA84780 NPE node: 000003FF7DA852C0\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff7da847d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  1)    icall  java/util/concurrent/atomic/AtomicInteger.getAndSet(I)I[#403  final virtual Method -136] [flags 0x20500 0x0 ] (in GPR_0034)  [     0x3ff7da84780] bci=[-1,2,6] rc=1 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  0)      ==>aRegLoad (in &GPR_0033) (X!=0 SeenRealReference )\r\n n40n     (  0)      ==>iRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\n\r\n [     0x3ff7db51ce0]                          CGIT    &GPR_0033,0,BH(mask=0x8),\r\n [     0x3ff7db52080]                          LG      GPR_0034,#405 8(&GPR_0033)\r\n [     0x3ff7dc00000]                          Label L0033:     # (Start of internal control flow)\r\n [     0x3ff7dc001a0]                          CS      GPR_0034,GPR_0032,#406 8(&GPR_0033)\r\n [     0x3ff7dc00280]                          BRC     BM(0x4), Label L0033\r\n [     0x3ff7dc00920]                          assocreg\r\n [     0x3ff7dc00360]                          Label L0032:     # (End of internal control flow)\r\n POST:\r\n {AssignAny:&GPR_0033:R} {AssignAny:GPR_0034:R} {AssignAny:GPR_0032:R}\r\n```\r\n\r\n```\r\n============================================================\r\n; Live regs: GPR=2 FPR=0 VRF=0 {&GPR_0033, GPR_0032}\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff58e047d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  2)    lcall  java/util/concurrent/atomic/AtomicLong.getAndSet(J)J[#403  final virtual Method -136] [flags 0x20500 0x0 ]  [     0x3ff58e04780] bci=[-1,2,6] rc=2 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  1)      ==>aRegLoad (in &GPR_0033) (SeenRealReference )\r\n n40n     (  1)      ==>lRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\n\r\nbuildDirectDispatch\r\nBuild Direct Call\r\n\r\nGC Point at 000003FF58F80BD0 has preserved register map 1fc0\r\n------------------------------\r\n n6n      (  0)  NULLCHK on n41n [#32]                                                                [     0x3ff58e047d0] bci=[-1,2,6] rc=0 vc=172 vn=- li=2 udi=- nc=1\r\n n5n      (  1)    lcall  java/util/concurrent/atomic/AtomicLong.getAndSet(J)J[#403  final virtual Method -136] [flags 0x20500 0x0 ] (in GPR_0034)  [     0x3ff58e04780] bci=[-1,2,6] rc=1 vc=172 vn=- li=2 udi=- nc=2\r\n n41n     (  0)      ==>aRegLoad (in &GPR_0033) (X!=0 SeenRealReference )\r\n n40n     (  0)      ==>lRegLoad (in GPR_0032) (cannotOverflow SeenRealReference )\r\n------------------------------\r\n\r\n [     0x3ff58ed1ce0]                          CGIT    &GPR_0033,0,BH(mask=0x8),\r\n [     0x3ff58f811c0]                          assocreg\r\n  PRE:\r\n {GPR1:&GPR_0033:R} {GPR2:GPR_0032:R}\r\n [     0x3ff58f80bd0]                          BRASL   GPR_0039, 0x000003FF58F80B60\r\n POST:\r\n {GPR2:GPR_0034:D} {GPR0:D_GPR_0035:D}* {GPR1:D_GPR_0036:D}* {GPR3:D_GPR_0037:D}* {GPR4:D_GPR_0038:D}* {GPR14:GPR_0039:D} {FPR0:D_FPR_0040:D}* {FPR1:D_FPR_0041:D}*\r\n {FPR2:D_FPR_0042:D}* {FPR3:D_FPR_0043:D}* {FPR4:D_FPR_0044:D}* {FPR5:D_FPR_0045:D}* {FPR6:D_FPR_0046:D}* {FPR7:D_FPR_0047:D}* {FPR8:D_FPR_0048:D}* {FPR9:D_FPR_0049:D}*\r\n {FPR10:D_FPR_0050:D}* {FPR11:D_FPR_0051:D}* {FPR12:D_FPR_0052:D}* {FPR13:D_FPR_0053:D}* {FPR14:D_FPR_0054:D}* {FPR15:D_FPR_0055:D}* {VRF16:D_VRF_0056:D}* {VRF17:D_VRF_0057:D}*\r\n {VRF18:D_VRF_0058:D}* {VRF19:D_VRF_0059:D}* {VRF20:D_VRF_0060:D}* {VRF21:D_VRF_0061:D}* {VRF22:D_VRF_0062:D}* {VRF23:D_VRF_0063:D}* {VRF24:D_VRF_0064:D}* {VRF25:D_VRF_0065:D}*\r\n {VRF26:D_VRF_0066:D}* {VRF27:D_VRF_0067:D}* {VRF28:D_VRF_0068:D}* {VRF29:D_VRF_0069:D}* {VRF30:D_VRF_0070:D}* {VRF31:D_VRF_0071:D}*\r\n ```\r\n\r\nIt looks like we are suppressing the IL inlining of `AtomicInteger.getAndSet` and `AtomicLong.getAndSet`, then in the case of  `AtomicInteger.getAndSet` we are recognizing the call site and generating some custom assembly. Since the `Atomic*` class methods are not intrinsics, we should probably not be suppressing inlining these methods and instead rely on the `Unsafe` atomic intrinsic implementations.",
      "reactions": {
        "url": "https://api.github.com/repos/eclipse-openj9/openj9/issues/comments/2429604204/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "performed_via_github_app": null
    }
  ]
}